import os
import requests

# DeepL API Key
DEEPL_API_KEY = os.getenv("DEEPL_API_KEY")

# 翻訳対象ファイル
SOURCE_FILE = "README.md"

# 出力ファイル（言語コード: ファイル名）
TARGET_LANGS = {
    "EN": "README.en.md",
    "ES": "README.es.md",
    "NL": "README.nl.md",
    "ZH": "README.zh.md",
    "KO": "README.ko.md",
    "FR": "README.fr.md",
    "DE": "README.de.md"
}

# DeepL API エンドポイント
DEEPL_URL = "https://api-free.deepl.com/v2/translate"

def translate_text(text, target_lang):
    """DeepL API を使ってテキストを翻訳"""
    data = {
        "auth_key": DEEPL_API_KEY,
        "text": text,
        "target_lang": target_lang
    }
    response = requests.post(DEEPL_URL, data=data)
    result = response.json()
    return result["translations"][0]["text"]

def main():
    # README.md を読み込む
    with open(SOURCE_FILE, "r", encoding="utf-8") as f:
        source_text = f.read()

    # 各言語に翻訳してファイル生成
    for lang, filename in TARGET_LANGS.items():
        print(f"Translating to {lang} → {filename}")
        translated = translate_text(source_text, lang)

        with open(filename, "w", encoding="utf-8") as f:
            f.write(translated)

    print("All translations completed.")

if __name__ == "__main__":
    main()
